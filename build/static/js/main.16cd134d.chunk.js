(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{169:function(e,t,n){},171:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(38),i=n.n(s),u=n(4),o=n.n(u),l=n(9),c=n(12),p=n(13),d=n(16),h=n(14),f=n(17),m=n(15),b=n(25),g=n.n(b),v={login:function(){var e=Object(l.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},E=n(172),y=n(173),w=n(180),O=n(174),j=function(e){return a.a.createElement("form",{onSubmit:e.login},a.a.createElement(E.a,null,a.a.createElement(y.a,null,"username:"),a.a.createElement(w.a,{type:"text",value:e.username,onChange:e.handleUsernameChange}),a.a.createElement(y.a,null,"password:"),a.a.createElement(w.a,{type:"password",value:e.password,onChange:e.handlePasswordChange}),a.a.createElement("br",null),a.a.createElement(O.a,{type:"submit",bsStyle:"primary",block:!0},"Login")))},k=n(181),C=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){if(null===this.props.notification||""===this.props.notification)return a.a.createElement("div",null);var e="error"!==this.props.notificationType?"info":"danger";return a.a.createElement(k.a,{bsStyle:e},this.props.notification)}}]),t}(a.a.Component),x=Object(m.b)(function(e){return{notification:e.notification.message,notificationType:e.notification.type}})(C),B={message:"",type:"info"},U=function(e,t,n){return function(){var r=Object(l.a)(o.a.mark(function r(a){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a({type:"NOTIFY",data:{message:e,type:t}}),r.next=3,setTimeout(function(){a({type:"CLEAR",data:{message:"",type:"info"}})},1e3*n);case 3:case"end":return r.stop()}},r,this)}));return function(e){return r.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFY":return{message:t.data.message,type:t.data.type};case"CLEAR":return{message:"",type:"info"};default:return e}},I=function(){return g.a.get("/api/users").then(function(e){return e.data})},L={users:[],user:null},A=function(e){return function(){var t=Object(l.a)(o.a.mark(function t(n){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:window.localStorage.setItem("blogUser",JSON.stringify(e)),n({type:"SET_USER",data:e});case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE":return{users:t.data,user:null};case"ADD_BLOG":var n=t.data.user._id,r=e.users.find(function(e){return e.id===n}),a=e.users.filter(function(e){return e.id!==n}),s={_id:t.data.id,title:t.data.title,author:t.data.author,likes:t.data.likes};return r.blogs.push(s),a.push(r),{users:a,user:e.user};case"DELETE_BLOG":var i=t.data.user._id,u=e.users.find(function(e){return e.id===i}),o=e.users.filter(function(e){return e.id!==i}),l=u.blogs.filter(function(e){return e._id!==t.data.id});return u.blogs=l,o.push(u),{users:o,user:e.user};case"SET_USER":return{users:e.users,user:t.data};default:return e}},D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleUsernameChange=function(e){n.setState({username:e.target.value})},n.handlePasswordChange=function(e){n.setState({password:e.target.value})},n.handleLogin=function(){var e=Object(l.a)(o.a.mark(function e(t){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,v.login({username:n.state.username,password:n.state.password});case 4:r=e.sent,n.props.setUser(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n.props.notify("Invalid username or password","error",5);case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t){return e.apply(this,arguments)}}(),n.state={username:"",password:""},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h2",null,"Log in to application"),a.a.createElement(x,null),a.a.createElement(j,{username:this.state.username,password:this.state.password,handleUsernameChange:this.handleUsernameChange,handlePasswordChange:this.handlePasswordChange,login:this.handleLogin}))}}]),t}(a.a.Component),_={notify:U,setUser:A},N=Object(m.b)(function(e){return{theUser:e.users.user}},_)(D),G=n(179),z=n(175),F=n(176),M=n(57),J=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).logout=function(e){e.preventDefault(),window.localStorage.removeItem("blogUser"),window.location.replace("/")},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h2",null,"Blogs"),a.a.createElement(G.a,{fluid:!0},a.a.createElement(z.a,null,a.a.createElement(M.LinkContainer,{to:"/"},a.a.createElement(F.a,null,"Blogs")),a.a.createElement(M.LinkContainer,{to:"/users"},a.a.createElement(F.a,null,"Users")),a.a.createElement(F.a,null,this.props.theUser.name," logged in"),a.a.createElement(F.a,null,a.a.createElement(G.a.Form,null,a.a.createElement(O.a,{onClick:this.logout,bsSize:"xsmall"},"logout"))))))}}]),t}(a.a.Component),P=Object(m.b)(function(e){return{theUser:e.users.user}})(J),R=n(53),V=function(e){var t=e.blog;return a.a.createElement("div",{className:"blogList"},a.a.createElement(R.a,{id:"detailLink",to:"/blogs/".concat(t.id)},t.title," ",t.author),a.a.createElement("br",null))},Z=function(e){return a.a.createElement("form",{onSubmit:e.handleCreate},a.a.createElement(E.a,null,a.a.createElement("div",null,a.a.createElement(y.a,null,"title:"),a.a.createElement(w.a,{type:"text",value:e.tila.newTitle,onChange:e.handleTitleChange})),a.a.createElement("div",null,a.a.createElement(y.a,null,"author:"),a.a.createElement(w.a,{type:"text",value:e.tila.newAuthor,onChange:e.handleAuthorChange})),a.a.createElement("div",null,a.a.createElement(y.a,null,"url:"),a.a.createElement(w.a,{type:"text",value:e.tila.newUrl,onChange:e.handleUrlChange})),a.a.createElement("br",null),a.a.createElement(O.a,{type:"submit",bsStyle:"primary",block:!0},"create")))},K=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return a.a.createElement("div",null,a.a.createElement("div",{style:e},a.a.createElement(O.a,{id:"create",onClick:this.toggleVisibility},this.props.buttonLabel)),a.a.createElement("div",{style:t},this.props.children,a.a.createElement(O.a,{onClick:this.toggleVisibility},"cancel")))}}]),t}(a.a.Component),Y={getAll:function(){return g.a.get("/api/blogs").then(function(e){return e.data})},addBlog:function(){var e=Object(l.a)(o.a.mark(function e(t,n){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/blogs",t,{headers:{Authorization:"Bearer "+n}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),likeBlog:function(){var e=Object(l.a)(o.a.mark(function e(t,n){var r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/api/blogs/"+t.id,e.next=3,g.a.put(r,t,{headers:{Authorization:"Bearer "+n}});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(l.a)(o.a.mark(function e(t,n){var r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/api/blogs/"+t,e.next=3,g.a.delete(r,{headers:{Authorization:"Bearer "+n}});case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),commentBlog:function(){var e=Object(l.a)(o.a.mark(function e(t,n){var r,a,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r="/api/blogs/"+t+"/comments",a={comment:n},e.next=4,g.a.post(r,a);case 4:return s=e.sent,e.abrupt("return",s.data);case 6:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},q={blogs:[]},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_BLOGS":return{blogs:t.data};case"ADD_BLOG":var n=e.blogs.slice(0);return n.push(t.data),{blogs:n};case"DELETE_BLOG":return{blogs:e.blogs.filter(function(e){return e.id!==t.data.id})};case"LIKE_BLOG":var r=e.blogs.filter(function(e){return e.id!==t.data.id});return r.push(t.data),{blogs:r};case"COMMENT_BLOG":var a=e.blogs.filter(function(e){return e.id!==t.data.id});return a.push(t.data),{blogs:a};default:return e}},Q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleTitleChange=function(){return function(e){e.preventDefault(),n.setState({newTitle:e.target.value})}},n.handleAuthorChange=function(){return function(e){e.preventDefault(),n.setState({newAuthor:e.target.value})}},n.handleUrlChange=function(){return function(e){e.preventDefault(),n.setState({newUrl:e.target.value})}},n.handleCreate=function(){return function(){var e=Object(l.a)(o.a.mark(function e(t){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==n.state.newTitle&&""!==n.state.newAuthor&&""!==n.state.newUrl){e.next=4;break}return n.props.notify("Title, author and url must be given","error",5),e.abrupt("return");case 4:return r={id:"123",title:n.state.newTitle,author:n.state.newAuthor,url:n.state.newUrl},e.prev=5,e.next=8,n.props.addBlog(r,n.props.theUser.token);case 8:n.setState({newTitle:""}),n.setState({newAuthor:""}),n.setState({newUrl:""}),n.blogForm.toggleVisibility(),n.props.notify("a new blog ".concat(r.title," by ").concat(r.author," added"),"info",5),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),n.props.notify("Error creating a new blog","error",5);case 18:case"end":return e.stop()}},e,this,[[5,15]])}));return function(t){return e.apply(this,arguments)}}()},n.state={newTitle:"",newAuthor:"",newUrl:""},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement(x,null),this.props.blogs.sort(function(e,t){return e.likes>t.likes?-1:e.likes<t.likes?1:0}).map(function(e){return a.a.createElement(V,{key:e.id,blog:e})}),a.a.createElement("h2",null,"Create new"),a.a.createElement(K,{buttonLabel:"new blog",ref:function(t){return e.blogForm=t}},a.a.createElement(Z,{tila:this.state,handleTitleChange:this.handleTitleChange(),handleAuthorChange:this.handleAuthorChange(),handleUrlChange:this.handleUrlChange(),handleCreate:this.handleCreate()})))}}]),t}(a.a.Component),W={notify:U,addBlog:function(e,t){return function(){var n=Object(l.a)(o.a.mark(function n(r){var a;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y.addBlog(e,t);case 2:(a=n.sent).id=a._id,r({type:"ADD_BLOG",data:a});case 5:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}},X=Object(m.b)(function(e){return{blogs:e.blogs.blogs,theUser:e.users.user}},W)(Q),$=n(177),ee=n(168),te=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(h.a)(t).call(this,e))).handleCommentChange=function(e){e.preventDefault(),n.setState({newComment:e.target.value})},n.likeThisBlog=function(){var e=Object(l.a)(o.a.mark(function e(t){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),(r=n.props.blogs.find(function(e){return e.id===t.target.getAttribute("id")})).likes++,e.prev=3,e.next=6,n.props.likeBlog(r,n.props.theUser.token);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),n.props.notify("Error performing like functionality","error",5);case 11:case"end":return e.stop()}},e,this,[[3,8]])}));return function(t){return e.apply(this,arguments)}}(),n.deleteThisBlog=function(){var e=Object(l.a)(o.a.mark(function e(t){var r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r=t.target.getAttribute("id"),a=n.props.blogs.find(function(e){return e.id===r});try{window.confirm("delete ".concat(a.title," by ").concat(a.author))&&(n.props.history.push("/"),n.props.deleteBlog(a,n.props.theUser.token))}catch(s){n.props.notify("Error deleting blog","error",5)}case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.commentThisBlog=function(){var e=Object(l.a)(o.a.mark(function e(t){var r,a,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=t.target.getAttribute("id"),a=n.props.blogs.find(function(e){return e.id===r}),e.prev=3,void 0===n.state.newComment||""===n.state.newComment){e.next=10;break}return s=n.state.newComment,e.next=8,n.props.commentBlog(a,s);case 8:n.setState({newComment:""}),n.props.notify('comment: "'.concat(s,'" added'),"info",5);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),n.props.notify("Error commenting blog","error",5);case 15:case"end":return e.stop()}},e,this,[[3,12]])}));return function(t){return e.apply(this,arguments)}}(),n.state={newComment:""},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.blogs.find(function(t){return t.id===e.props.blogId});void 0===t.comments&&(t.comments=[]);var n={display:""},r=null;t&&t.user&&(r=t.user.name,this.props.theUser&&this.props.theUser.name!==t.user.name&&(n={display:"none"}));var s={display:r?"":"none"};return t?a.a.createElement("div",null,a.a.createElement(x,null),a.a.createElement("h2",null,t.title),a.a.createElement("div",{className:"blogDetail"},a.a.createElement("a",{href:t.url},t.url),a.a.createElement("br",null),a.a.createElement("a",null,t.likes," likes ",a.a.createElement("button",{id:t.id,onClick:this.likeThisBlog},"like")),a.a.createElement("br",null),a.a.createElement("a",{style:s},"added by ",r),a.a.createElement("br",null),a.a.createElement("button",{style:n,id:t.id,onClick:this.deleteThisBlog},"delete")),a.a.createElement("div",null,a.a.createElement("h3",null,"Comments"),a.a.createElement($.a,null,t.comments.map(function(e){return a.a.createElement(ee.a,{key:e},e)}))),a.a.createElement(E.a,null,a.a.createElement("div",null,a.a.createElement(w.a,{type:"text",value:this.state.newComment,onChange:this.handleCommentChange}),a.a.createElement("br",null),a.a.createElement(O.a,{id:t.id,onClick:this.commentThisBlog,bsStyle:"primary",block:!0},"add comment")))):a.a.createElement("div",null)}}]),t}(a.a.Component),ne={notify:U,likeBlog:function(e,t){return function(){var n=Object(l.a)(o.a.mark(function n(r){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y.likeBlog(e,t);case 2:r({type:"LIKE_BLOG",data:e});case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},deleteBlog:function(e,t){return function(){var n=Object(l.a)(o.a.mark(function n(r){return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y.deleteBlog(e.id,t);case 2:r({type:"DELETE_BLOG",data:e});case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},commentBlog:function(e,t){return function(){var n=Object(l.a)(o.a.mark(function n(r){var a;return o.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Y.commentBlog(e.id,t);case 2:(a=n.sent).id=a._id,a.user=e.user,r({type:"COMMENT_BLOG",data:a});case 6:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()}},re=Object(m.b)(function(e){return{blogs:e.blogs.blogs,theUser:e.users.user}},ne)(te),ae=n(178),se=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"Users"),a.a.createElement(ae.a,{striped:!0,bordered:!0,condensed:!0},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("td",null),a.a.createElement("td",null,"blogs added")),this.props.users.map(function(e){return a.a.createElement("tr",{key:e.id},a.a.createElement("td",null,a.a.createElement(R.a,{to:"/users/".concat(e.id)},e.name)),a.a.createElement("td",null,e.blogs.length))}))))}}]),t}(a.a.Component),ie=Object(m.b)(function(e){return{users:e.users.users}})(se),ue=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(a)))).logout=function(e){e.preventDefault(),window.localStorage.removeItem("blogUser"),window.location.reload()},n.getTheBlogs=function(e){var t=[];return n.props.blogs.forEach(function(n){n.user&&n.user._id===e&&t.push(n)}),t},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.users.find(function(t){return t.id===e.props.userId});return a.a.createElement("div",null,a.a.createElement("h2",null,t.name),a.a.createElement("h3",null,"Added blogs"),a.a.createElement($.a,null,this.getTheBlogs(this.props.userId).map(function(e){return a.a.createElement(ee.a,{key:e.id},e.title," by ",e.author)})))}}]),t}(a.a.Component),oe=Object(m.b)(function(e,t){return{blogs:e.blogs.blogs,users:e.users.users,userId:t.theUserId}})(ue),le=n(79),ce=n(54),pe=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark(function e(){var t,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.initializeBlogs();case 2:return e.next=4,this.props.initializeUsers();case 4:(t=window.localStorage.getItem("blogUser"))&&(n=JSON.parse(t),this.props.setUser(n));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return null===this.props.theUser?a.a.createElement("div",{className:"container"},a.a.createElement(N,null)):a.a.createElement(le.a,null,a.a.createElement("div",{className:"container"},a.a.createElement(P,null),a.a.createElement(ce.a,{exact:!0,path:"/",render:function(){return a.a.createElement(X,null)}}),a.a.createElement(ce.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match,n=e.history;return a.a.createElement(re,{blogId:t.params.id,history:n})}}),a.a.createElement(ce.a,{exact:!0,path:"/users",render:function(){return a.a.createElement(ie,null)}}),a.a.createElement(ce.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return a.a.createElement(oe,{theUserId:t.params.id})}})))}}]),t}(a.a.Component),de={initializeBlogs:function(){return function(){var e=Object(l.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.getAll();case 2:n=e.sent,t({type:"INITIALIZE_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},initializeUsers:function(){return function(){var e=Object(l.a)(o.a.mark(function e(t){var n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:n=e.sent,t({type:"INITIALIZE",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},setUser:A},he=Object(m.b)(function(e){return{theUser:e.users.user}},de)(pe),fe=(n(169),n(33)),me=n(90),be=Object(fe.c)({blogs:H,users:S,notification:T}),ge=Object(fe.d)(be,Object(fe.a)(me.a)),ve=function(){i.a.render(a.a.createElement(m.a,{store:ge},a.a.createElement(he,null)),document.getElementById("root"))};ge.subscribe(ve),ve()},91:function(e,t,n){e.exports=n(171)}},[[91,2,1]]]);
//# sourceMappingURL=main.16cd134d.chunk.js.map